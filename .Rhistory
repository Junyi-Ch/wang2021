# Load required packages
library(tidyverse)
library(knitr)
library(kableExtra)
# Load required packages
library(tidyverse)
library(knitr)
# Set theme for plots
theme_set(theme_minimal(base_size = 12))
ls
cd desktop
getwd()
cd wang2021
setwd("wang2021")
getwd()
# Load required packages
library(tidyverse)
library(jsonlite)
library(readxl)
# Set folder path
data_path <- "pilot_data"
# List all Excel files
files <- list.files(data_path, pattern = "\\.xlsx$", full.names = TRUE)
# Number of participants
num_participants <- length(files)
cat("Number of participants:", num_participants, "\n")
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[8]
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Convert variables to appropriate types
all_data <- all_data %>%
mutate(
age = as.numeric(age),
gender = as.factor(gender),
education = as.factor(education),
english_proficiency = as.factor(english_proficiency),
mandarin_proficiency = as.factor(mandarin_proficiency)
)
# Number of participants
num_participants <- length(files)
cat("Number of participants:", num_participants, "\n")
# Set folder path
data_path <- "pilot_data"
# List all Excel files
files <- list.files(data_path, pattern = "\\.xlsx$", full.names = TRUE)
# Number of participants
num_participants <- length(files)
cat("Number of participants:", num_participants, "\n")
dat <- read_excel("pilot_data/pilot_1.xlsx")
getwd()
list.files("pilot_data")
files <- list.files("pilot_data", pattern = "\\.xlsx$", full.names = TRUE)
list.files("pilot_data")
list.files("pilot_data")
list.files("pilot_data")
getwd()
setwd("pilot_data")
setwd("wang2021")
# Load required packages
library(tidyverse)
library(jsonlite)
library(readxl)
# Set folder path
data_path <- "pilot_data"
# List all Excel files
files <- list.files(data_path, pattern = "\\.xlsx$", full.names = TRUE)
getwd()
# Set folder path
data_path <- "wang2021/pilot_data"
# List all Excel files
files <- list.files(data_path, pattern = "\\.xlsx$", full.names = TRUE)
list.files
files <- list.files("wang2021/pilot_data", pattern = "\\.xlsx$", full.names = TRUE)
files <- list.files("wang2021/pilot_data", pattern = "\\.xlsx$", full.names = TRUE)
# Number of participants
num_participants <- length(files)
cat("Number of participants:", num_participants, "\n")
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[8]
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[8]
if (is.na(demo_json) || demo_json == "") {
warning("No demographics JSON found in file: ", f)
return(tibble())  # return empty tibble for this file
}
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Convert variables to appropriate types
all_data <- all_data %>%
mutate(
age = as.numeric(age),
gender = as.factor(gender),
education = as.factor(education),
english_proficiency = as.factor(english_proficiency),
mandarin_proficiency = as.factor(mandarin_proficiency)
)
dat <- read_excel(files[1])
dat$response[8]
dat <- read_excel(files[1])
dat$response[7]
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[7]
if (is.na(demo_json) || demo_json == "") {
warning("No demographics JSON found in file: ", f)
return(tibble())  # return empty tibble for this file
}
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Convert variables to appropriate types
all_data <- all_data %>%
mutate(
age = as.numeric(age),
gender = as.factor(gender),
education = as.factor(education),
english_proficiency = as.factor(english_proficiency),
mandarin_proficiency = as.factor(mandarin_proficiency)
)
# Summarize results
summary_table <- all_data %>%
summarise(
n_participants = n(),
mean_age = mean(age, na.rm = TRUE),
sd_age = sd(age, na.rm = TRUE)
)
# Print summaries
cat("\n--- Participant Summary ---\n")
print(summary_table)
cat("\n--- Gender Breakdown ---\n")
print(table(all_data$gender))
cat("\n--- English Proficiency ---\n")
print(table(all_data$english_proficiency))
cat("\n--- Mandarin Proficiency ---\n")
print(table(all_data$mandarin_proficiency))
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[7]
if (is.na(demo_json) || demo_json == "") {
warning("No demographics JSON found in file: ", f)
return(tibble())  # return empty tibble for this file
}
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Convert variables to appropriate types
all_data <- all_data %>%
mutate(
age = as.numeric(age),
gender = as.factor(gender),
education = as.factor(education),
english_proficiency = as.factor(english_proficiency),
mandarin_proficiency = as.factor(mandarin_proficiency)
)
ggplot(all_data, aes(x = age)) +
geom_histogram(binwidth = 1, fill = "#1976D2", alpha = 0.7) +
labs(title = "Age Distribution",
x = "Age",
y = "Count") +
scale_x_continuous(breaks = seq(min(participants$age), max(participants$age), by = 2))
# Read and process all Excel files
all_data <- map_dfr(files, function(f) {
dat <- read_excel(f)
# Get the row that contains demographics (row 8 under column "response")
demo_json <- dat$response[7]
if (is.na(demo_json) || demo_json == "") {
warning("No demographics JSON found in file: ", f)
return(tibble())  # return empty tibble for this file
}
# Parse the JSON string to R list/data frame
demo <- fromJSON(demo_json)
# Add participant ID (from file name)
demo$participant_id <- tools::file_path_sans_ext(basename(f))
as_tibble(demo)
})
# Convert variables to appropriate types
all_data <- all_data %>%
mutate(
age = as.numeric(age),
gender = as.factor(gender),
education = as.factor(education),
english_proficiency = as.factor(english_proficiency),
mandarin_proficiency = as.factor(mandarin_proficiency)
)
ggplot(all_data, aes(x = age)) +
geom_histogram(binwidth = 1, fill = "#1976D2", alpha = 0.7) +
labs(title = "Age Distribution",
x = "Age",
y = "Count") +
scale_x_continuous(breaks = seq(min(all_data$age), max(all_data$age), by = 2))
# Summarize results
summary_table <- all_data %>%
summarise(
n_participants = n(),
mean_age = mean(age, na.rm = TRUE),
sd_age = sd(age, na.rm = TRUE)
)
# Print summaries
cat("\n--- Participant Summary ---\n")
print(summary_table)
cat("\n--- Gender Breakdown ---\n")
print(table(all_data$gender))
cat("\n--- English Proficiency ---\n")
print(table(all_data$english_proficiency))
cat("\n--- Mandarin Proficiency ---\n")
print(table(all_data$mandarin_proficiency))
